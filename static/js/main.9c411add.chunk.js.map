{"version":3,"sources":["components/postprocessing/DistortionPass.tsx","utils/file.ts","components/postprocessing/ripple.ts","components/postprocessing/RipplePass.tsx","components/Effect.tsx","components/ImagePlane.tsx","components/TCanvas.tsx","components/App.tsx","reportWebVitals.ts","index.tsx"],"names":["extend","ShaderPass","DistortionPass","props","enabled","progress","scale","distortionRef","useRef","shader","useMemo","uniforms","tDiffuse","value","u_time","u_progress","u_scale","vertexShader","fragmentShader","useFrame","current","ref","attachArray","args","publicPath","path","process","RippleRenderer","_texture","_scene","_target","_camera","_meshs","_max","_frequency","_mouse","THREE","_prevMouse","_currentWave","_cameraProps","frustumSize","window","innerHeight","width","innerWidth","height","near","far","_createMesh","geometry","material","map","transparent","blending","depthTest","depthWrite","i","mesh","clone","rotateZ","Math","PI","random","visible","add","push","_handleMouseMove","e","x","clientX","y","clientY","_handleResize","left","right","top","bottom","updateProjectionMatrix","setSize","_setNewWave","position","set","opacity","_trackMousePos","distance","distanceTo","update","gl","uTexture","setRenderTarget","render","texture","clear","forEach","rotation","z","dispose","removeEventListener","this","addEventListener","RipplePass","fallback","Ripple","shaderRef","rippleTexture","useTexture","effect","u_displacement","useEffect","EffectComposer","RenderPass","Effect","dist_datas","useControls","min","max","step","ripple_datas","composerRef","useThree","scene","camera","size","ImagePlane","name","textures","u_texture","TCanvas","fov","aspect","dpr","devicePixelRatio","attach","OrbitControls","Stats","App","style","reportWebVitals","onPerfEntry","Function","then","getCLS","getFID","getFCP","getLCP","getTTFB","ReactDOM","StrictMode","document","getElementById"],"mappings":"gQAIAA,YAAO,CAAEC,iBAQF,IAAMC,EAA0C,SAAAC,GACtD,MAAoDA,EAA5CC,eAAR,WAAoDD,EAA5BE,gBAAxB,MAAmC,EAAnC,IAAoDF,EAAdG,aAAtC,MAA8C,EAA9C,EAEMC,EAAgBC,iBAAmB,MAEnCC,EAAuBC,mBAAQ,WACpC,MAAO,CACNC,SAAU,CACTC,SAAU,CAAEC,MAAO,MACnBC,OAAQ,CAAED,MAAO,GACjBE,WAAY,CAAEF,MAAO,GACrBG,QAAS,CAAEH,MAAO,IAEnBI,aAAcA,EACdC,eAAgBA,KAEf,IAMH,OAJAC,aAAS,WACRZ,EAAca,QAAST,SAASG,OAAOD,OAAS,OAIhD,4BACCQ,IAAKd,EACLe,YAAY,SACZC,KAAM,CAACd,GACPL,QAASA,EACT,4BAA2BC,EAC3B,yBAAwBC,KAMrBW,EAAY,wIASZC,EAAc,4tB,QCxDPM,EAAa,SAACC,GAC1B,MAAOC,kBAAyBD,G,qBCCpBE,EAAb,aAoBC,WAAoBC,GAA0B,IAAD,gCAAzBA,WAAyB,KAnBrCC,YAmBqC,OAlBrCC,aAkBqC,OAjBrCC,aAiBqC,OAhBrCC,OAAuB,GAgBc,KAdrCC,KAAO,IAc8B,KAZrCC,WAAa,EAYwB,KAVrCC,OAAS,IAAIC,UAAc,EAAG,GAUO,KARrCC,WAAa,IAAID,UAAc,EAAG,GAQG,KANrCE,aAAe,EAMsB,KAcrCC,aAAe,WACtB,IAAMC,EAAcC,OAAOC,YAG3B,MAAO,CAAEC,MADQH,GADFC,OAAOG,WAAaH,OAAOC,aACD,EACtBG,OADyBL,EAAc,EAC5BM,MAAO,IAAMC,IAAK,MAlBJ,KAqBrCC,YAAc,WAUrB,IATA,IACMC,EAAW,IAAIb,gBADR,OAEPc,EAAW,IAAId,oBAAwB,CAC5Ce,IAAK,EAAKvB,SACVwB,aAAa,EACbC,SAAUjB,mBACVkB,WAAW,EACXC,YAAY,IAEJC,EAAI,EAAGA,EAAI,EAAKvB,KAAMuB,IAAK,CACnC,IAAMC,EAAO,IAAIrB,OAAWa,EAASS,QAASR,EAASQ,SACvDD,EAAKE,QAAQ,EAAIC,KAAKC,GAAKD,KAAKE,UAChCL,EAAKM,SAAU,EACf,EAAKlC,OAAOmC,IAAIP,GAChB,EAAKzB,OAAOiC,KAAKR,KApC0B,KAwCrCS,iBAAmB,SAACC,GAC3B,EAAKhC,OAAOiC,EAAID,EAAEE,QAAU5B,OAAOG,WAAa,EAChD,EAAKT,OAAOmC,EAAI7B,OAAOC,YAAc,EAAIyB,EAAEI,SA1CC,KA6CrCC,cAAgB,WACvB,MAA0B,EAAKjC,eAAvBI,EAAR,EAAQA,MAAOE,EAAf,EAAeA,OACf,EAAKd,QAAQ0C,MAAQ9B,EACrB,EAAKZ,QAAQ2C,MAAQ/B,EACrB,EAAKZ,QAAQ4C,IAAM9B,EACnB,EAAKd,QAAQ6C,QAAU/B,EACvB,EAAKd,QAAQ8C,yBACb,EAAK/C,QAAQgD,QAAQrC,OAAOG,WAAYH,OAAOC,cApDH,KAuDrCqC,YAAc,WACrB,IAAMtB,EAAO,EAAKzB,OAAO,EAAKM,cAC9BmB,EAAKM,SAAU,EACfN,EAAKuB,SAASC,IAAI,EAAK9C,OAAOiC,EAAG,EAAKjC,OAAOmC,EAAG,GAChDb,EAAKnD,MAAM8D,EAAIX,EAAKnD,MAAMgE,EAAI,GAC5Bb,EAAKP,SAAqCgC,QAAU,IA5DV,KA+DrCC,eAAiB,WAExB,IAAMC,EAAW,EAAKjD,OAAOkD,WAAW,EAAKhD,YACzC,EAAKH,WAAakD,IACrB,EAAKL,cACL,EAAKzC,cAAgB,EAAKA,aAAe,GAAK,EAAKL,MAGpD,EAAKI,WAAW+B,EAAI,EAAKjC,OAAOiC,EAChC,EAAK/B,WAAWiC,EAAI,EAAKnC,OAAOmC,GAxEY,KAgF7CgB,OAAS,SAACC,EAAyBC,GAClC,EAAKL,iBAELI,EAAGE,gBAAgB,EAAK3D,SACxByD,EAAGG,OAAO,EAAK7D,OAAQ,EAAKE,SAC5ByD,EAAS3E,MAAQ,EAAKiB,QAAQ6D,QAC9BJ,EAAGE,gBAAgB,MACnBF,EAAGK,QAEH,EAAK5D,OAAO6D,SAAQ,SAAApC,GACnB,GAAIA,EAAKM,QAAS,CACjB,IAAMb,EAAWO,EAAKP,SACtBO,EAAKqC,SAASC,GAAK,IACnB7C,EAASgC,SAAW,IACpBzB,EAAKnD,MAAM8D,EAAI,IAAOX,EAAKnD,MAAM8D,EAAI,IACrCX,EAAKnD,MAAMgE,EAAIb,EAAKnD,MAAM8D,EACtBlB,EAASgC,QAAU,OAAOzB,EAAKM,SAAU,QAhGH,KAwG7CiC,QAAU,WACTvD,OAAOwD,oBAAoB,YAAa,EAAK/B,kBAC7CzB,OAAOwD,oBAAoB,SAAU,EAAKzB,gBAzG1C0B,KAAKrE,OAAS,IAAIO,QAClB8D,KAAKpE,QAAU,IAAIM,oBAAwBK,OAAOG,WAAYH,OAAOC,aAErE,MAAqCwD,KAAK3D,eAAlCI,EAAR,EAAQA,MAAOE,EAAf,EAAeA,OAAQC,EAAvB,EAAuBA,KAAMC,EAA7B,EAA6BA,IAC7BmD,KAAKnE,QAAU,IAAIK,sBAA0BO,EAAOA,EAAOE,GAASA,EAAQC,EAAMC,GAClFmD,KAAKnE,QAAQiD,SAASC,IAAI,EAAG,EAAG,GAEhCiB,KAAKlD,cAELP,OAAO0D,iBAAiB,YAAaD,KAAKhC,kBAC1CzB,OAAO0D,iBAAiB,SAAUD,KAAK1B,kBC1BzCxE,YAAO,CAAEC,iBAMF,IAAMmG,EAAkC,SAAAjG,GAC9C,MAA2BA,EAAnBC,eAAR,SAEA,OACC,cAAC,WAAD,CAAUiG,SAAU,KAApB,SACC,cAAC,EAAD,CAAQjG,QAASA,OAUdkG,EAA0B,SAAAnG,GAC/B,MAA2BA,EAAnBC,eAAR,SAEMmG,EAAY/F,iBAAmB,MAE/BgG,EAAgBC,YAAWjF,EAAW,+BACtCkF,EAAShG,mBAAQ,kBAAM,IAAIiB,EAAe6E,KAAgB,CAACA,IAE3D/F,EAAuBC,mBAAQ,WACpC,MAAO,CACNC,SAAU,CACTC,SAAU,CAAEC,MAAO,MACnB8F,eAAgB,CAAE9F,MAAO,OAE1BI,aAAcA,EACdC,eAAgBA,KAEf,IAUH,OARA0F,qBAAU,WACT,OAAO,kBAAMF,EAAOV,aAClB,CAACU,IAEJvF,aAAS,YAAa,IAAVoE,EAAS,EAATA,GACXmB,EAAOpB,OAAOC,EAAIgB,EAAUnF,QAAST,SAASgG,mBAGxC,4BAAYtF,IAAKkF,EAAWjF,YAAY,SAASC,KAAM,CAACd,GAASL,QAASA,KAI5Ea,EAAY,wIASZC,EAAc,ubC7DpBlB,YAAO,CAAE6G,mBAAgBC,eAAY7G,iBAE9B,IAAM8G,EAAc,WAC1B,IAAMC,EAAaC,YAAY,aAAc,CAC5C7G,SAAS,EACTC,SAAU,CAAEQ,MAAO,EAAGqG,IAAK,EAAGC,IAAK,EAAGC,KAAM,KAC5C9G,MAAO,CAAEO,MAAO,EAAGqG,IAAK,EAAGC,IAAK,EAAGC,KAAM,OAGpCC,EAAeJ,YAAY,SAAU,CAC1C7G,SAAS,IAGJkH,EAAc9G,iBAAuB,MAC3C,EAAoC+G,cAA5BhC,EAAR,EAAQA,GAAIiC,EAAZ,EAAYA,MAAOC,EAAnB,EAAmBA,OAAQC,EAA3B,EAA2BA,KAU3B,OARAd,qBAAU,WACTU,EAAYlG,QAAS0D,QAAQ4C,EAAK/E,MAAO+E,EAAK7E,UAC5C,CAAC6E,IAEJvG,aAAS,WACRmG,EAAYlG,QAASsE,WACnB,GAGF,iCAAgBrE,IAAKiG,EAAa/F,KAAM,CAACgE,GAAzC,UACC,4BAAYjE,YAAY,SAASC,KAAM,CAACiG,EAAOC,KAC/C,cAAC,EAAD,eAAoBT,IACpB,cAAC,EAAD,eAAgBK,Q,QC9BNM,EAAkB,WAC9B,IAAMlG,EAAO,SAACmG,GAAD,OAAkBpG,EAAW,kBAAD,OAAmBoG,EAAnB,UACnCC,EAAWpB,YAAW,CAAChF,EAAK,SAAUA,EAAK,SAAUA,EAAK,WAE1DyB,EAAW,SAACyC,GAAD,OAChB,IAAIvD,iBAAqB,CACxBzB,SAAU,CACTmH,UAAW,CAAEjH,MAAO8E,IAErB1E,aAAcA,EACdC,eAAgBA,KAGlB,OACC,mCACE2G,EAAS1E,KAAI,SAACwC,EAASnC,GAAV,OACb,cAAC,IAAD,CAAejC,KAAM,CAAC,EAAG,MAAkB2B,SAAUA,EAASyC,GAAUrF,MAAO,IAAM0E,SAAU,CAACxB,EAAI,EAAG,EAAG,IAA9FA,SAOVvC,EAAY,wIASZC,EAAc,gJC/BP6G,EAAe,WAC3B,OACC,eAAC,IAAD,CACCN,OAAQ,CACPzC,SAAU,CAAC,EAAG,EAAG,GACjBgD,IAAK,GACLC,OAAQxF,OAAOG,WAAaH,OAAOC,YACnCI,KAAM,GACNC,IAAK,KAENmF,IAAKzF,OAAO0F,iBARb,UAUC,uBAAOC,OAAO,aAAa7G,KAAM,CAAC,UAElC,cAAC8G,EAAA,EAAD,CAAeD,OAAO,kBAEtB,cAACE,EAAA,EAAD,IAEA,cAAC,WAAD,CAAUjC,SAAU,KAApB,SACC,cAAC,EAAD,MAGD,cAAC,EAAD,QCzBUkC,EAAW,WACvB,OACC,qBAAKC,MAAO,CAAE7F,MAAO,QAASE,OAAQ,SAAtC,SACC,cAAC,EAAD,OCQY4F,EAZS,SAACC,GACnBA,GAAeA,aAAuBC,UACxC,6BAAqBC,MAAK,YAAkD,IAA/CC,EAA8C,EAA9CA,OAAQC,EAAsC,EAAtCA,OAAQC,EAA8B,EAA9BA,OAAQC,EAAsB,EAAtBA,OAAQC,EAAc,EAAdA,QAC3DJ,EAAOH,GACPI,EAAOJ,GACPK,EAAOL,GACPM,EAAON,GACPO,EAAQP,OCHdQ,IAASxD,OACR,cAAC,IAAMyD,WAAP,UACC,cAAC,EAAD,MAEDC,SAASC,eAAe,SAMzBZ,M","file":"static/js/main.9c411add.chunk.js","sourcesContent":["import { useMemo, useRef, VFC } from 'react';\r\nimport { ShaderPass } from 'three-stdlib';\r\nimport { extend, useFrame } from '@react-three/fiber';\r\n\r\nextend({ ShaderPass })\r\n\r\ntype DistortionPassType = {\r\n\tenabled?: boolean\r\n\tprogress?: number\r\n\tscale?: number\r\n}\r\n\r\nexport const DistortionPass: VFC<DistortionPassType> = props => {\r\n\tconst { enabled = true, progress = 0, scale = 1 } = props\r\n\r\n\tconst distortionRef = useRef<ShaderPass>(null)\r\n\r\n\tconst shader: THREE.Shader = useMemo(() => {\r\n\t\treturn {\r\n\t\t\tuniforms: {\r\n\t\t\t\ttDiffuse: { value: null },\r\n\t\t\t\tu_time: { value: 0 },\r\n\t\t\t\tu_progress: { value: 0 },\r\n\t\t\t\tu_scale: { value: 1 }\r\n\t\t\t},\r\n\t\t\tvertexShader: vertexShader,\r\n\t\t\tfragmentShader: fragmentShader\r\n\t\t}\r\n\t}, [])\r\n\r\n\tuseFrame(() => {\r\n\t\tdistortionRef.current!.uniforms.u_time.value += 0.01\r\n\t})\r\n\r\n\treturn (\r\n\t\t<shaderPass\r\n\t\t\tref={distortionRef}\r\n\t\t\tattachArray=\"passes\"\r\n\t\t\targs={[shader]}\r\n\t\t\tenabled={enabled}\r\n\t\t\tuniforms-u_progress-value={progress}\r\n\t\t\tuniforms-u_scale-value={scale}\r\n\t\t/>\r\n\t)\r\n}\r\n\r\n// --------------------------------------------------------\r\nconst vertexShader = `\r\nvarying vec2 v_uv;\r\n\r\nvoid main() {\r\n  v_uv = uv;\r\n  gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\r\n}\r\n`\r\n\r\nconst fragmentShader = `\r\nuniform sampler2D tDiffuse;\r\nuniform float u_time;\r\nuniform float u_progress;\r\nuniform float u_scale;\r\nvarying vec2 v_uv;\r\n\r\nvoid main() {\r\n  vec2 uv = v_uv;\r\n\r\n  vec2 p = 2.0 * v_uv - 1.0; // -1 ~ 1\r\n  p += 0.1 * cos(u_scale * 3.7 * p.yx + 1.4 * u_time + vec2(2.2, 3.4));\r\n  p += 0.1 * cos(u_scale * 3.0 * p.yx + 1.0 * u_time + vec2(1.2, 3.4));\r\n  p += 0.3 * cos(u_scale * 5.0 * p.yx + 2.6 * u_time + vec2(4.2, 1.4));\r\n  p += 0.3 * cos(u_scale * 7.5 * p.yx + 3.6 * u_time + vec2(12.2, 3.4));\r\n\r\n\tuv.x = mix(v_uv.x, length(p), u_progress);\r\n  uv.y = mix(v_uv.y, 0.5 * length(p) + 0.15, u_progress);\r\n  \r\n  vec4 color = texture2D(tDiffuse, uv);\r\n  \r\n  gl_FragColor = color;\r\n  // gl_FragColor = vec4(vec3(length(p)), 1.0);\r\n}\r\n`\r\n","export const publicPath = (path: string) => {\r\n\treturn process.env.PUBLIC_URL + path\r\n}\r\n","import * as THREE from 'three';\r\n\r\nexport class RippleRenderer {\r\n\tprivate _scene: THREE.Scene\r\n\tprivate _target: THREE.WebGLRenderTarget\r\n\tprivate _camera: THREE.OrthographicCamera\r\n\tprivate _meshs: THREE.Mesh[] = []\r\n\t/** 波紋の最大描画数 */\r\n\tprivate _max = 100\r\n\t/** 1フレームでマウスがどれだけ移動したら描画するか */\r\n\tprivate _frequency = 5\r\n\t/** マウス座標 */\r\n\tprivate _mouse = new THREE.Vector2(0, 0)\r\n\t/** 前のフレームでのマウス座標 */\r\n\tprivate _prevMouse = new THREE.Vector2(0, 0)\r\n\t/** 現在のフレームで描画された波紋のインデックス */\r\n\tprivate _currentWave = 0\r\n\r\n\t/**\r\n\t * コンストラクタ\r\n\t * @param _texture 波紋のテクスチャー\r\n\t */\r\n\tconstructor(private _texture: THREE.Texture) {\r\n\t\tthis._scene = new THREE.Scene()\r\n\t\tthis._target = new THREE.WebGLRenderTarget(window.innerWidth, window.innerHeight)\r\n\t\t// camera\r\n\t\tconst { width, height, near, far } = this._cameraProps()\r\n\t\tthis._camera = new THREE.OrthographicCamera(-width, width, height, -height, near, far)\r\n\t\tthis._camera.position.set(0, 0, 2)\r\n\t\t// mesh\r\n\t\tthis._createMesh()\r\n\t\t// events\r\n\t\twindow.addEventListener('mousemove', this._handleMouseMove)\r\n\t\twindow.addEventListener('resize', this._handleResize)\r\n\t}\r\n\r\n\tprivate _cameraProps = () => {\r\n\t\tconst frustumSize = window.innerHeight\r\n\t\tconst aspect = window.innerWidth / window.innerHeight\r\n\t\tconst [w, h] = [(frustumSize * aspect) / 2, frustumSize / 2]\r\n\t\treturn { width: w, height: h, near: -1000, far: 1000 }\r\n\t}\r\n\r\n\tprivate _createMesh = () => {\r\n\t\tconst size = 64\r\n\t\tconst geometry = new THREE.PlaneGeometry(size, size)\r\n\t\tconst material = new THREE.MeshBasicMaterial({\r\n\t\t\tmap: this._texture,\r\n\t\t\ttransparent: true,\r\n\t\t\tblending: THREE.AdditiveBlending,\r\n\t\t\tdepthTest: false,\r\n\t\t\tdepthWrite: false\r\n\t\t})\r\n\t\tfor (let i = 0; i < this._max; i++) {\r\n\t\t\tconst mesh = new THREE.Mesh(geometry.clone(), material.clone())\r\n\t\t\tmesh.rotateZ(2 * Math.PI * Math.random())\r\n\t\t\tmesh.visible = false\r\n\t\t\tthis._scene.add(mesh)\r\n\t\t\tthis._meshs.push(mesh)\r\n\t\t}\r\n\t}\r\n\r\n\tprivate _handleMouseMove = (e: MouseEvent) => {\r\n\t\tthis._mouse.x = e.clientX - window.innerWidth / 2\r\n\t\tthis._mouse.y = window.innerHeight / 2 - e.clientY\r\n\t}\r\n\r\n\tprivate _handleResize = () => {\r\n\t\tconst { width, height } = this._cameraProps()\r\n\t\tthis._camera.left = -width\r\n\t\tthis._camera.right = width\r\n\t\tthis._camera.top = height\r\n\t\tthis._camera.bottom = -height\r\n\t\tthis._camera.updateProjectionMatrix()\r\n\t\tthis._target.setSize(window.innerWidth, window.innerHeight)\r\n\t}\r\n\r\n\tprivate _setNewWave = () => {\r\n\t\tconst mesh = this._meshs[this._currentWave]\r\n\t\tmesh.visible = true\r\n\t\tmesh.position.set(this._mouse.x, this._mouse.y, 0)\r\n\t\tmesh.scale.x = mesh.scale.y = 0.2\r\n\t\t;(mesh.material as THREE.MeshBasicMaterial).opacity = 0.5\r\n\t}\r\n\r\n\tprivate _trackMousePos = () => {\r\n\t\t// 今のマウス座標と前回のフレームのマウス座標の距離\r\n\t\tconst distance = this._mouse.distanceTo(this._prevMouse)\r\n\t\tif (this._frequency < distance) {\r\n\t\t\tthis._setNewWave()\r\n\t\t\tthis._currentWave = (this._currentWave + 1) % this._max\r\n\t\t\t// console.log(this._currentWave)\r\n\t\t}\r\n\t\tthis._prevMouse.x = this._mouse.x\r\n\t\tthis._prevMouse.y = this._mouse.y\r\n\t}\r\n\r\n\t/**\r\n\t * 描画を更新する\r\n\t * @param gl メインレンダラー\r\n\t * @param uTexture 波紋の描画結果を格納するuniform\r\n\t */\r\n\tupdate = (gl: THREE.WebGLRenderer, uTexture: THREE.IUniform<any>) => {\r\n\t\tthis._trackMousePos()\r\n\r\n\t\tgl.setRenderTarget(this._target)\r\n\t\tgl.render(this._scene, this._camera)\r\n\t\tuTexture.value = this._target.texture\r\n\t\tgl.setRenderTarget(null)\r\n\t\tgl.clear()\r\n\r\n\t\tthis._meshs.forEach(mesh => {\r\n\t\t\tif (mesh.visible) {\r\n\t\t\t\tconst material = mesh.material as THREE.MeshBasicMaterial\r\n\t\t\t\tmesh.rotation.z += 0.02\r\n\t\t\t\tmaterial.opacity *= 0.97\r\n\t\t\t\tmesh.scale.x = 0.98 * mesh.scale.x + 0.17\r\n\t\t\t\tmesh.scale.y = mesh.scale.x\r\n\t\t\t\tif (material.opacity < 0.002) mesh.visible = false\r\n\t\t\t}\r\n\t\t})\r\n\t}\r\n\r\n\t/**\r\n\t * インスタンスを破棄する\r\n\t */\r\n\tdispose = () => {\r\n\t\twindow.removeEventListener('mousemove', this._handleMouseMove)\r\n\t\twindow.removeEventListener('resize', this._handleResize)\r\n\t}\r\n}\r\n","import React, { Suspense, useEffect, useMemo, useRef, VFC } from 'react';\r\nimport { ShaderPass } from 'three-stdlib';\r\nimport { useTexture } from '@react-three/drei';\r\nimport { extend, useFrame } from '@react-three/fiber';\r\nimport { publicPath } from '../../utils/file';\r\nimport { RippleRenderer } from './ripple';\r\n\r\nextend({ ShaderPass })\r\n\r\ntype RipplePassType = {\r\n\tenabled?: boolean\r\n}\r\n\r\nexport const RipplePass: VFC<RipplePassType> = props => {\r\n\tconst { enabled = true } = props\r\n\r\n\treturn (\r\n\t\t<Suspense fallback={null}>\r\n\t\t\t<Ripple enabled={enabled} />\r\n\t\t</Suspense>\r\n\t)\r\n}\r\n\r\n// ========================================================\r\ntype RippleType = {\r\n\tenabled?: boolean\r\n}\r\n\r\nconst Ripple: VFC<RippleType> = props => {\r\n\tconst { enabled = true } = props\r\n\r\n\tconst shaderRef = useRef<ShaderPass>(null)\r\n\r\n\tconst rippleTexture = useTexture(publicPath('/assets/textures/brush.png'))\r\n\tconst effect = useMemo(() => new RippleRenderer(rippleTexture), [rippleTexture])\r\n\r\n\tconst shader: THREE.Shader = useMemo(() => {\r\n\t\treturn {\r\n\t\t\tuniforms: {\r\n\t\t\t\ttDiffuse: { value: null },\r\n\t\t\t\tu_displacement: { value: null }\r\n\t\t\t},\r\n\t\t\tvertexShader: vertexShader,\r\n\t\t\tfragmentShader: fragmentShader\r\n\t\t}\r\n\t}, [])\r\n\r\n\tuseEffect(() => {\r\n\t\treturn () => effect.dispose()\r\n\t}, [effect])\r\n\r\n\tuseFrame(({ gl }) => {\r\n\t\teffect.update(gl, shaderRef.current!.uniforms.u_displacement)\r\n\t})\r\n\r\n\treturn <shaderPass ref={shaderRef} attachArray=\"passes\" args={[shader]} enabled={enabled} />\r\n}\r\n\r\n// --------------------------------------------------------\r\nconst vertexShader = `\r\nvarying vec2 v_uv;\r\n\r\nvoid main() {\r\n  v_uv = uv;\r\n  gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\r\n}\r\n`\r\n\r\nconst fragmentShader = `\r\nuniform sampler2D tDiffuse;\r\nuniform sampler2D u_displacement;\r\nvarying vec2 v_uv;\r\n\r\nfloat PI = 3.141592653589;\r\n\r\nvoid main() {\r\n  vec2 uv = v_uv;\r\n\r\n  vec4 disp = texture2D(u_displacement, uv);\r\n  float theta = disp.r * 2.0 * PI;\r\n  vec2 dir = vec2(sin(theta), cos(theta));\r\n  uv += dir * disp.r * 0.1;\r\n\r\n  vec4 color = texture2D(tDiffuse, uv);\r\n\r\n  gl_FragColor = color;\r\n  // gl_FragColor = texture2D(u_displacement, v_uv);\r\n}\r\n`\r\n","import { useControls } from 'leva';\r\nimport React, { useEffect, useRef, VFC } from 'react';\r\nimport { EffectComposer, RenderPass, ShaderPass } from 'three-stdlib';\r\nimport { extend, useFrame, useThree } from '@react-three/fiber';\r\nimport { DistortionPass } from './postprocessing/DistortionPass';\r\nimport { RipplePass } from './postprocessing/RipplePass';\r\n\r\nextend({ EffectComposer, RenderPass, ShaderPass })\r\n\r\nexport const Effect: VFC = () => {\r\n\tconst dist_datas = useControls('Distortion', {\r\n\t\tenabled: true,\r\n\t\tprogress: { value: 0, min: 0, max: 1, step: 0.01 },\r\n\t\tscale: { value: 1, min: 0, max: 5, step: 0.01 }\r\n\t})\r\n\r\n\tconst ripple_datas = useControls('Ripple', {\r\n\t\tenabled: true\r\n\t})\r\n\r\n\tconst composerRef = useRef<EffectComposer>(null)\r\n\tconst { gl, scene, camera, size } = useThree()\r\n\r\n\tuseEffect(() => {\r\n\t\tcomposerRef.current!.setSize(size.width, size.height)\r\n\t}, [size])\r\n\r\n\tuseFrame(() => {\r\n\t\tcomposerRef.current!.render()\r\n\t}, 1)\r\n\r\n\treturn (\r\n\t\t<effectComposer ref={composerRef} args={[gl]}>\r\n\t\t\t<renderPass attachArray=\"passes\" args={[scene, camera]} />\r\n\t\t\t<DistortionPass {...dist_datas} />\r\n\t\t\t<RipplePass {...ripple_datas} />\r\n\t\t</effectComposer>\r\n\t)\r\n}\r\n","import React, { VFC } from 'react';\r\nimport * as THREE from 'three';\r\nimport { Plane, useTexture } from '@react-three/drei';\r\nimport { publicPath } from '../utils/file';\r\n\r\nexport const ImagePlane: VFC = () => {\r\n\tconst path = (name: string) => publicPath(`/assets/images/${name}.jpg`)\r\n\tconst textures = useTexture([path('thum1'), path('thum2'), path('thum3')])\r\n\r\n\tconst material = (texture: THREE.Texture) =>\r\n\t\tnew THREE.ShaderMaterial({\r\n\t\t\tuniforms: {\r\n\t\t\t\tu_texture: { value: texture }\r\n\t\t\t},\r\n\t\t\tvertexShader: vertexShader,\r\n\t\t\tfragmentShader: fragmentShader\r\n\t\t})\r\n\r\n\treturn (\r\n\t\t<>\r\n\t\t\t{textures.map((texture, i) => (\r\n\t\t\t\t<Plane key={i} args={[1, 1 * (315 / 600)]} material={material(texture)} scale={0.98} position={[i - 1, 0, 0]} />\r\n\t\t\t))}\r\n\t\t</>\r\n\t)\r\n}\r\n\r\n// --------------------------------------------------------\r\nconst vertexShader = `\r\nvarying vec2 v_uv;\r\n\r\nvoid main() {\r\n  v_uv = uv;\r\n  gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\r\n}\r\n`\r\n\r\nconst fragmentShader = `\r\nuniform sampler2D u_texture;\r\nvarying vec2 v_uv;\r\n\r\nvoid main() {\r\n  vec4 color = texture2D(u_texture, v_uv);\r\n  gl_FragColor = color;\r\n}\r\n`\r\n","import React, { Suspense, VFC } from 'react';\r\nimport { OrbitControls, Stats } from '@react-three/drei';\r\nimport { Canvas } from '@react-three/fiber';\r\nimport { Effect } from './Effect';\r\nimport { ImagePlane } from './ImagePlane';\r\n\r\nexport const TCanvas: VFC = () => {\r\n\treturn (\r\n\t\t<Canvas\r\n\t\t\tcamera={{\r\n\t\t\t\tposition: [0, 0, 2],\r\n\t\t\t\tfov: 50,\r\n\t\t\t\taspect: window.innerWidth / window.innerHeight,\r\n\t\t\t\tnear: 0.1,\r\n\t\t\t\tfar: 2000\r\n\t\t\t}}\r\n\t\t\tdpr={window.devicePixelRatio}>\r\n\t\t\t{/* canvas color */}\r\n\t\t\t<color attach=\"background\" args={['#000']} />\r\n\t\t\t{/* camera controller */}\r\n\t\t\t<OrbitControls attach=\"orbitControls\" />\r\n\t\t\t{/* helper */}\r\n\t\t\t<Stats />\r\n\t\t\t{/* object */}\r\n\t\t\t<Suspense fallback={null}>\r\n\t\t\t\t<ImagePlane />\r\n\t\t\t</Suspense>\r\n\t\t\t{/* effect */}\r\n\t\t\t<Effect />\r\n\t\t</Canvas>\r\n\t)\r\n}\r\n","import React, { VFC } from 'react';\nimport { TCanvas } from './TCanvas';\n\nexport const App: VFC = () => {\n\treturn (\n\t\t<div style={{ width: '100vw', height: '100vh' }}>\n\t\t\t<TCanvas />\n\t\t</div>\n\t)\n}\n","import { ReportHandler } from 'web-vitals';\n\nconst reportWebVitals = (onPerfEntry?: ReportHandler) => {\n  if (onPerfEntry && onPerfEntry instanceof Function) {\n    import('web-vitals').then(({ getCLS, getFID, getFCP, getLCP, getTTFB }) => {\n      getCLS(onPerfEntry);\n      getFID(onPerfEntry);\n      getFCP(onPerfEntry);\n      getLCP(onPerfEntry);\n      getTTFB(onPerfEntry);\n    });\n  }\n};\n\nexport default reportWebVitals;\n","import './index.css';\nimport React from 'react';\nimport ReactDOM from 'react-dom';\nimport { App } from './components/App';\nimport reportWebVitals from './reportWebVitals';\n\nReactDOM.render(\n\t<React.StrictMode>\n\t\t<App />\n\t</React.StrictMode>,\n\tdocument.getElementById('root')\n)\n\n// If you want to start measuring performance in your app, pass a function\n// to log results (for example: reportWebVitals(console.log))\n// or send to an analytics endpoint. Learn more: https://bit.ly/CRA-vitals\nreportWebVitals()\n"],"sourceRoot":""}