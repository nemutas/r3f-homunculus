(this.webpackJsonpr3f_homunculus=this.webpackJsonpr3f_homunculus||[]).push([[0],{58:function(e,t,n){},79:function(e,t,n){"use strict";n.r(t);n(58);var r=n(0),i=n.n(r),a=n(26),s=n.n(a),o=n(9),c=n(6),u=n(14),l=function(e){var t,n=e.imagePath,i=e.linkPath,a=e.position,s=void 0===a?"bottom-right":a,o=e.size,l=void 0===o?[50,50]:o,v=Object(r.useState)(!1),m=Object(c.a)(v,2),f=m[0],_=m[1],p="/r3f-homunculus"+n;switch(s){case"top-left":t=h.topLeft;break;case"top-right":t=h.topRight;break;case"bottom-left":t=h.bottomLeft;break;default:t=h.bottomRight}return Object(u.jsx)("a",{style:t,href:i,target:"_blank",rel:"noreferrer noopener",onMouseEnter:function(){return _(!0)},onMouseLeave:function(){return _(!1)},children:Object(u.jsx)("img",{style:f?d.img:h.img,src:p,alt:"",width:l[0],height:l[1]})})},v={position:"absolute",fontSize:"0"},h={topLeft:Object(o.a)(Object(o.a)({},v),{},{top:"10px",left:"10px"}),topRight:Object(o.a)(Object(o.a)({},v),{},{top:"10px",right:"10px"}),bottomLeft:Object(o.a)(Object(o.a)({},v),{},{bottom:"10px",left:"10px"}),bottomRight:Object(o.a)(Object(o.a)({},v),{},{bottom:"10px",right:"10px"}),img:{objectFit:"cover",opacity:"0.5",transform:"rotate(0deg)",transition:"all 0.3s"}},d={img:Object(o.a)(Object(o.a)({},h.img),{},{opacity:"1",transform:"rotate(360deg)"})},m=n(84),f=n(85),_=n(18),p=n(46),b=n(83),g=n(81),j=n(45);Object(_.d)({ShaderPass:j.a});var x=function(e){var t=e.enabled,n=void 0===t||t,i=e.progress,a=void 0===i?0:i,s=e.scale,o=void 0===s?1:s,c=Object(r.useRef)(null),l=Object(r.useMemo)((function(){return{uniforms:{tDiffuse:{value:null},u_time:{value:0},u_progress:{value:0},u_scale:{value:1}},vertexShader:O,fragmentShader:w}}),[]);return Object(_.e)((function(){c.current.uniforms.u_time.value+=.01})),Object(u.jsx)("shaderPass",{ref:c,attachArray:"passes",args:[l],enabled:n,"uniforms-u_progress-value":a,"uniforms-u_scale-value":o})},O="\nvarying vec2 v_uv;\n\nvoid main() {\n  v_uv = uv;\n  gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}\n",w="\nuniform sampler2D tDiffuse;\nuniform float u_time;\nuniform float u_progress;\nuniform float u_scale;\nvarying vec2 v_uv;\n\nvoid main() {\n  vec2 uv = v_uv;\n\n  vec2 p = 2.0 * v_uv - 1.0; // -1 ~ 1\n  p += 0.1 * cos(u_scale * 3.7 * p.yx + 1.4 * u_time + vec2(2.2, 3.4));\n  p += 0.1 * cos(u_scale * 3.0 * p.yx + 1.0 * u_time + vec2(1.2, 3.4));\n  p += 0.3 * cos(u_scale * 5.0 * p.yx + 2.6 * u_time + vec2(4.2, 1.4));\n  p += 0.3 * cos(u_scale * 7.5 * p.yx + 3.6 * u_time + vec2(12.2, 3.4));\n\n\tuv.x = mix(v_uv.x, length(p), u_progress);\n  uv.y = mix(v_uv.y, 0.5 * length(p) + 0.15, u_progress);\n  \n  vec4 color = texture2D(tDiffuse, uv);\n  \n  gl_FragColor = color;\n  // gl_FragColor = vec4(vec3(length(p)), 1.0);\n}\n",y=n(80),M=function(e){return"/r3f-homunculus"+e},P=n(2),S=n(1),D=n(7),R=Object(P.a)((function e(t){var n=this;Object(S.a)(this,e),this._texture=t,this._scene=void 0,this._target=void 0,this._camera=void 0,this._meshs=[],this._max=100,this._frequency=5,this._mouse=new D.Vector2(0,0),this._prevMouse=new D.Vector2(0,0),this._currentWave=0,this._cameraProps=function(){var e=window.innerHeight;return{width:e*(window.innerWidth/window.innerHeight)/2,height:e/2,near:-1e3,far:1e3}},this._createMesh=function(){for(var e=new D.PlaneGeometry(64,64),t=new D.MeshBasicMaterial({map:n._texture,transparent:!0,blending:D.AdditiveBlending,depthTest:!1,depthWrite:!1}),r=0;r<n._max;r++){var i=new D.Mesh(e.clone(),t.clone());i.rotateZ(2*Math.PI*Math.random()),i.visible=!1,n._scene.add(i),n._meshs.push(i)}},this._handleMouseMove=function(e){n._mouse.x=e.clientX-window.innerWidth/2,n._mouse.y=window.innerHeight/2-e.clientY},this._handleResize=function(){var e=n._cameraProps(),t=e.width,r=e.height;n._camera.left=-t,n._camera.right=t,n._camera.top=r,n._camera.bottom=-r,n._camera.updateProjectionMatrix(),n._target.setSize(window.innerWidth,window.innerHeight)},this._setNewWave=function(){var e=n._meshs[n._currentWave];e.visible=!0,e.position.set(n._mouse.x,n._mouse.y,0),e.scale.x=e.scale.y=.2,e.material.opacity=.5},this._trackMousePos=function(){var e=n._mouse.distanceTo(n._prevMouse);n._frequency<e&&(n._setNewWave(),n._currentWave=(n._currentWave+1)%n._max),n._prevMouse.x=n._mouse.x,n._prevMouse.y=n._mouse.y},this.update=function(e,t){n._trackMousePos(),e.setRenderTarget(n._target),e.render(n._scene,n._camera),t.value=n._target.texture,e.setRenderTarget(null),e.clear(),n._meshs.forEach((function(e){if(e.visible){var t=e.material;e.rotation.z+=.02,t.opacity*=.97,e.scale.x=.98*e.scale.x+.17,e.scale.y=e.scale.x,t.opacity<.002&&(e.visible=!1)}}))},this.dispose=function(){window.removeEventListener("mousemove",n._handleMouseMove),window.removeEventListener("resize",n._handleResize)},this._scene=new D.Scene,this._target=new D.WebGLRenderTarget(window.innerWidth,window.innerHeight);var r=this._cameraProps(),i=r.width,a=r.height,s=r.near,o=r.far;this._camera=new D.OrthographicCamera(-i,i,a,-a,s,o),this._camera.position.set(0,0,2),this._createMesh(),window.addEventListener("mousemove",this._handleMouseMove),window.addEventListener("resize",this._handleResize)}));Object(_.d)({ShaderPass:j.a});var k=function(e){var t=e.enabled,n=void 0===t||t;return Object(u.jsx)(r.Suspense,{fallback:null,children:Object(u.jsx)(W,{enabled:n})})},W=function(e){var t=e.enabled,n=void 0===t||t,i=Object(r.useRef)(null),a=Object(y.a)(M("/assets/textures/brush.png")),s=Object(r.useMemo)((function(){return new R(a)}),[a]),o=Object(r.useMemo)((function(){return{uniforms:{tDiffuse:{value:null},u_displacement:{value:null}},vertexShader:C,fragmentShader:L}}),[]);return Object(r.useEffect)((function(){return function(){return s.dispose()}}),[s]),Object(_.e)((function(e){var t=e.gl;s.update(t,i.current.uniforms.u_displacement)})),Object(u.jsx)("shaderPass",{ref:i,attachArray:"passes",args:[o],enabled:n})},C="\nvarying vec2 v_uv;\n\nvoid main() {\n  v_uv = uv;\n  gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}\n",L="\nuniform sampler2D tDiffuse;\nuniform sampler2D u_displacement;\nvarying vec2 v_uv;\n\nfloat PI = 3.141592653589;\n\nvoid main() {\n  vec2 uv = v_uv;\n\n  vec4 disp = texture2D(u_displacement, uv);\n  float theta = disp.r * 2.0 * PI;\n  vec2 dir = vec2(sin(theta), cos(theta));\n  uv += dir * disp.r * 0.1;\n\n  vec4 color = texture2D(tDiffuse, uv);\n\n  gl_FragColor = color;\n  // gl_FragColor = texture2D(u_displacement, v_uv);\n}\n";Object(_.d)({EffectComposer:b.a,RenderPass:g.a,ShaderPass:j.a});var z=function(){var e=Object(p.a)("Distortion",{enabled:!0,progress:{value:0,min:0,max:1,step:.01},scale:{value:1,min:0,max:5,step:.01}}),t=Object(p.a)("Ripple",{enabled:!0}),n=Object(r.useRef)(null),i=Object(_.g)(),a=i.gl,s=i.scene,c=i.camera,l=i.size;return Object(r.useEffect)((function(){n.current.setSize(l.width,l.height)}),[l]),Object(_.e)((function(){n.current.render()}),1),Object(u.jsxs)("effectComposer",{ref:n,args:[a],children:[Object(u.jsx)("renderPass",{attachArray:"passes",args:[s,c]}),Object(u.jsx)(x,Object(o.a)({},e)),Object(u.jsx)(k,Object(o.a)({},t))]})},F=n(82),E=function(){var e=function(e){return M("/assets/images/".concat(e,".jpg"))},t=Object(y.a)([e("thum1"),e("thum2"),e("thum3")]),n=function(e){return new D.ShaderMaterial({uniforms:{u_texture:{value:e}},vertexShader:T,fragmentShader:H})};return Object(u.jsx)(u.Fragment,{children:t.map((function(e,t){return Object(u.jsx)(F.a,{args:[1,.525],material:n(e),scale:.98,position:[t-1,0,0]},t)}))})},T="\nvarying vec2 v_uv;\n\nvoid main() {\n  v_uv = uv;\n  gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}\n",H="\nuniform sampler2D u_texture;\nvarying vec2 v_uv;\n\nvoid main() {\n  vec4 color = texture2D(u_texture, v_uv);\n  gl_FragColor = color;\n}\n",I=function(){return Object(u.jsxs)(_.a,{camera:{position:[0,0,2],fov:50,aspect:window.innerWidth/window.innerHeight,near:.1,far:2e3},dpr:window.devicePixelRatio,children:[Object(u.jsx)("color",{attach:"background",args:["#000"]}),Object(u.jsx)(m.a,{attach:"orbitControls"}),Object(u.jsx)(f.a,{}),Object(u.jsx)(r.Suspense,{fallback:null,children:Object(u.jsx)(E,{})}),Object(u.jsx)(z,{})]})},V=function(){return Object(u.jsxs)("div",{style:{width:"100vw",height:"100vh"},children:[Object(u.jsx)(I,{}),Object(u.jsx)(l,{imagePath:"/assets/icons/github.svg",linkPath:"https://github.com/nemutas/r3f-homunculus"})]})},A=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,86)).then((function(t){var n=t.getCLS,r=t.getFID,i=t.getFCP,a=t.getLCP,s=t.getTTFB;n(e),r(e),i(e),a(e),s(e)}))};s.a.render(Object(u.jsx)(i.a.StrictMode,{children:Object(u.jsx)(V,{})}),document.getElementById("root")),A()}},[[79,1,2]]]);
//# sourceMappingURL=main.8bde96f7.chunk.js.map