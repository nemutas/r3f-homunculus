(this.webpackJsonpr3f_homunculus=this.webpackJsonpr3f_homunculus||[]).push([[0],{58:function(e,n,t){},79:function(e,n,t){"use strict";t.r(n);t(58);var r=t(0),i=t.n(r),a=t(26),s=t.n(a),o=t(84),u=t(85),c=t(18),v=t(10),l=t(46),d=t(83),h=t(81),_=t(45),m=t(15);Object(c.d)({ShaderPass:_.a});var f=function(e){var n=e.enabled,t=void 0===n||n,i=e.progress,a=void 0===i?0:i,s=e.scale,o=void 0===s?1:s,u=Object(r.useRef)(null),v=Object(r.useMemo)((function(){return{uniforms:{tDiffuse:{value:null},u_time:{value:0},u_progress:{value:0},u_scale:{value:1}},vertexShader:p,fragmentShader:g}}),[]);return Object(c.e)((function(){u.current.uniforms.u_time.value+=.01})),Object(m.jsx)("shaderPass",{ref:u,attachArray:"passes",args:[v],enabled:t,"uniforms-u_progress-value":a,"uniforms-u_scale-value":o})},p="\nvarying vec2 v_uv;\n\nvoid main() {\n  v_uv = uv;\n  gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}\n",g="\nuniform sampler2D tDiffuse;\nuniform float u_time;\nuniform float u_progress;\nuniform float u_scale;\nvarying vec2 v_uv;\n\nvoid main() {\n  vec2 uv = v_uv;\n\n  vec2 p = 2.0 * v_uv - 1.0; // -1 ~ 1\n  p += 0.1 * cos(u_scale * 3.7 * p.yx + 1.4 * u_time + vec2(2.2, 3.4));\n  p += 0.1 * cos(u_scale * 3.0 * p.yx + 1.0 * u_time + vec2(1.2, 3.4));\n  p += 0.3 * cos(u_scale * 5.0 * p.yx + 2.6 * u_time + vec2(4.2, 1.4));\n  p += 0.3 * cos(u_scale * 7.5 * p.yx + 3.6 * u_time + vec2(12.2, 3.4));\n\n\tuv.x = mix(v_uv.x, length(p), u_progress);\n  uv.y = mix(v_uv.y, 0.5 * length(p) + 0.15, u_progress);\n  \n  vec4 color = texture2D(tDiffuse, uv);\n  gl_FragColor = color;\n\n  // gl_FragColor = vec4(length(p), 0.0, 0.0, 1.0);\n\t// gl_FragColor = vec4(uv, 0.0, 1.0);\n}\n",j=t(80),b=function(e){return"/r3f-homunculus"+e},x=t(2),w=t(1),O=t(7),M=Object(x.a)((function e(n){var t=this;Object(w.a)(this,e),this._texture=n,this._scene=void 0,this._target=void 0,this._camera=void 0,this._meshs=[],this._max=100,this._frequency=5,this._mouse=new O.Vector2(0,0),this._prevMouse=new O.Vector2(0,0),this._currentWave=0,this._cameraProps=function(){var e=window.innerHeight;return{width:e*(window.innerWidth/window.innerHeight)/2,height:e/2,near:-1e3,far:1e3}},this._createMesh=function(){for(var e=new O.PlaneGeometry(64,64),n=new O.MeshBasicMaterial({map:t._texture,transparent:!0,blending:O.AdditiveBlending,depthTest:!1,depthWrite:!1}),r=0;r<t._max;r++){var i=new O.Mesh(e.clone(),n.clone());i.rotateZ(2*Math.PI*Math.random()),i.visible=!1,t._scene.add(i),t._meshs.push(i)}},this._handleMouseMove=function(e){t._mouse.x=e.clientX-window.innerWidth/2,t._mouse.y=window.innerHeight/2-e.clientY},this._handleResize=function(){var e=t._cameraProps(),n=e.width,r=e.height;t._camera.left=-n,t._camera.right=n,t._camera.top=r,t._camera.bottom=-r,t._camera.updateProjectionMatrix(),t._target.setSize(window.innerWidth,window.innerHeight)},this._setNewWave=function(){var e=t._meshs[t._currentWave];e.visible=!0,e.position.set(t._mouse.x,t._mouse.y,0),e.scale.x=e.scale.y=.2,e.material.opacity=.5},this._trackMousePos=function(){var e=t._mouse.distanceTo(t._prevMouse);t._frequency<e&&(t._setNewWave(),t._currentWave=(t._currentWave+1)%t._max),t._prevMouse.x=t._mouse.x,t._prevMouse.y=t._mouse.y},this.update=function(e,n){t._trackMousePos(),e.setRenderTarget(t._target),e.render(t._scene,t._camera),n.value=t._target.texture,e.setRenderTarget(null),e.clear(),t._meshs.forEach((function(e){if(e.visible){var n=e.material;e.rotation.z+=.02,n.opacity*=.97,e.scale.x=.98*e.scale.x+.17,e.scale.y=e.scale.x,n.opacity<.002&&(e.visible=!1)}}))},this.dispose=function(){window.removeEventListener("mousemove",t._handleMouseMove),window.removeEventListener("resize",t._handleResize)},this._scene=new O.Scene,this._target=new O.WebGLRenderTarget(window.innerWidth,window.innerHeight);var r=this._cameraProps(),i=r.width,a=r.height,s=r.near,o=r.far;this._camera=new O.OrthographicCamera(-i,i,a,-a,s,o),this._camera.position.set(0,0,2),this._createMesh(),window.addEventListener("mousemove",this._handleMouseMove),window.addEventListener("resize",this._handleResize)}));Object(c.d)({ShaderPass:_.a});var y=function(e){var n=e.enabled,t=void 0===n||n;return Object(m.jsx)(r.Suspense,{fallback:null,children:Object(m.jsx)(P,{enabled:t})})},P=function(e){var n=e.enabled,t=void 0===n||n,i=Object(r.useRef)(null),a=Object(j.a)(b("/assets/textures/brush.png")),s=Object(r.useMemo)((function(){return new M(a)}),[a]),o=Object(r.useMemo)((function(){return{uniforms:{tDiffuse:{value:null},u_displacement:{value:null}},vertexShader:D,fragmentShader:S}}),[]);return Object(r.useEffect)((function(){return function(){return s.dispose()}}),[s]),Object(c.e)((function(e){var n=e.gl;s.update(n,i.current.uniforms.u_displacement)})),Object(m.jsx)("shaderPass",{ref:i,attachArray:"passes",args:[o],enabled:t})},D="\nvarying vec2 v_uv;\n\nvoid main() {\n  v_uv = uv;\n  gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}\n",S="\nuniform sampler2D tDiffuse;\nuniform sampler2D u_displacement;\nvarying vec2 v_uv;\n\nfloat PI = 3.141592653589;\n\nvoid main() {\n  vec2 uv = v_uv;\n\n  vec4 disp = texture2D(u_displacement, uv);\n  float theta = disp.r * 2.0 * PI;\n  vec2 dir = vec2(sin(theta), cos(theta));\n  uv += dir * disp.r * 0.1;\n\n  vec4 color = texture2D(tDiffuse, uv);\n\n  gl_FragColor = color;\n  // gl_FragColor = texture2D(u_displacement, v_uv);\n  // gl_FragColor = vec4(v_uv, 0.0, 1.0);\n}\n";Object(c.d)({EffectComposer:d.a,RenderPass:h.a,ShaderPass:_.a});var C=function(){var e=Object(l.a)("Distortion",{enabled:!0,progress:{value:0,min:0,max:1,step:.01},scale:{value:1,min:0,max:5,step:.01}}),n=Object(l.a)("Ripple",{enabled:!0}),t=Object(r.useRef)(null),i=Object(c.g)(),a=i.gl,s=i.scene,o=i.camera,u=i.size;return Object(r.useEffect)((function(){t.current.setSize(u.width,u.height)}),[u]),Object(c.e)((function(){t.current.render()}),1),Object(m.jsxs)("effectComposer",{ref:t,args:[a],children:[Object(m.jsx)("renderPass",{attachArray:"passes",args:[s,o]}),Object(m.jsx)(f,Object(v.a)({},e)),Object(m.jsx)(y,Object(v.a)({},n))]})},W=t(82),F=function(){var e=function(e){return b("/assets/images/".concat(e,".jpg"))},n=Object(j.a)([e("thum1"),e("thum2"),e("thum3")]),t=function(e){return new O.ShaderMaterial({uniforms:{u_texture:{value:e}},vertexShader:R,fragmentShader:z})};return Object(m.jsx)(m.Fragment,{children:n.map((function(e,n){return Object(m.jsx)(W.a,{args:[1,.525],material:t(e),scale:.98,position:[n-1,0,0]},n)}))})},R="\nvarying vec2 v_uv;\n\nvoid main() {\n  v_uv = uv;\n  gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}\n",z="\nuniform sampler2D u_texture;\nvarying vec2 v_uv;\n\nvoid main() {\n  vec4 color = texture2D(u_texture, v_uv);\n  gl_FragColor = color;\n}\n",E=function(){return Object(m.jsxs)(c.a,{camera:{position:[0,0,2],fov:50,aspect:window.innerWidth/window.innerHeight,near:.1,far:2e3},dpr:window.devicePixelRatio,children:[Object(m.jsx)("color",{attach:"background",args:["#000"]}),Object(m.jsx)(o.a,{attach:"orbitControls"}),Object(m.jsx)(u.a,{}),Object(m.jsx)(r.Suspense,{fallback:null,children:Object(m.jsx)(F,{})}),Object(m.jsx)(C,{})]})},k=function(){return Object(m.jsx)("div",{style:{width:"100vw",height:"100vh"},children:Object(m.jsx)(E,{})})},L=function(e){e&&e instanceof Function&&t.e(3).then(t.bind(null,86)).then((function(n){var t=n.getCLS,r=n.getFID,i=n.getFCP,a=n.getLCP,s=n.getTTFB;t(e),r(e),i(e),a(e),s(e)}))};s.a.render(Object(m.jsx)(i.a.StrictMode,{children:Object(m.jsx)(k,{})}),document.getElementById("root")),L()}},[[79,1,2]]]);
//# sourceMappingURL=main.70461454.chunk.js.map